#+TITLE: å¦‚ä½•å®‰è£… MacPorts å¹¶ä½¿ç”¨å›½å†…æº
#+DATE: 2022-12-14T22:38:00+08:00
#+DRAFT: false
#+TAGS[]: macOS macport
#+CATEGORIES[]: Tools

åœ¨macOSä¸Šä½¿ç”¨è¿‡ Homebrewï¼ŒNix å’Œ MacPorts è¿™å‡ ä¸ªåŒ…ç®¡ç†å™¨ï¼Œæ€»çš„æ¥è¯´ï¼ŒMacPorts çš„ä½“éªŒæœ€å¥½ï¼Œä½†å®ƒçš„å®‰è£…å¯¹å›½å†…ç”¨æˆ·å¾ˆä¸å‹å¥½ã€‚ä¸»è¦æ˜¯ç½‘ç»œçš„åŸå› ï¼Œåœ¨å›½å†…æ— æ³•è®¿é—® MacPortsçš„å®˜æ–¹æºã€‚

åœ¨æ­¤æ€»ç»“ä¸‹å®‰è£…æµç¨‹ï¼Œä¹Ÿè®¸å¯ä»¥å¸®åŠ©åˆ°é‡åˆ°åŒæ ·é—®é¢˜çš„æœ‹å‹ã€‚

* å®‰è£… MacPorts
å‚è€ƒ[[https://www.macports.org/install.php][å®˜ç½‘çš„å®‰è£…æŒ‡å—]]ï¼Œä¸‹è½½é€‚åˆçš„å®‰è£…åŒ…è¿›è¡Œå®‰è£…ã€‚

æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š
1. æ£€æŸ¥ XCode çš„å®‰è£…
   å¯ä»¥é€šè¿‡ https://developer.apple.com/download/all/ ä¸‹è½½å®‰è£… Xcode å’Œ Command Line Tools
2. å®‰è£…æ—¶è¦æ–­å¼€ç½‘ç»œï¼Œä¸ç„¶æ²¡æ³•å®‰è£…ã€‚
3. è‹¥å®‰è£…è‡³ â€œæ­£åœ¨è¿è¡Œè½¯ä»¶åŒ…è„šæœ¬â€ ä¼šå¡ä½ï¼Œçª—å£å…³ä¸æ‰
   - ç‚¹å‡» å®‰è£…å™¨ çª—å£ ï¼ŒCommand + Alt + Esc å¼ºåˆ¶é€€å‡º
   - æ‰“å¼€ç»ˆç«¯ï¼ˆå¦‚ iTerm æˆ–è€… terminalï¼‰
     #+begin_src bash
ps aux | grep install
sudo kill <process-number-of-macports>
     #+end_src

* æ›´æ¢ä¸ºå›½å†…çš„æº
å‚è€ƒ [[https://trac.macports.org/wiki/Mirrors#MacPortsSource][MacPorts Wiki]] é€‰æ‹© Chinaï¼ŒBeijing æºã€‚å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨[[https://mirrors.tuna.tsinghua.edu.cn/macports/][æ¸…åæº]]ã€‚è¿™é‡Œ Chinaï¼ŒBeijing æºä¸ºä¾‹ã€‚

** æ£€æŸ¥ profile æ–‡ä»¶æ˜¯å¦å¯è¯»å†™
#+begin_src bash
open /etc		# æ‰“å¼€ profile ç›®å½•
#+end_src
å³é”® profile æ–‡ä»¶ï¼Œ â€œæ˜¾ç¤ºç®€ä»‹â€æœ€ä¸‹é¢ç‚¹å³ä¸‹è§’çš„é”ğŸ”’ï¼Œè§£é”æœ€ä¸‹é¢åç§°æ¡†â€œç³»ç»Ÿâ€å¯¹åº”çš„æƒé™ï¼Œè‹¥æ˜¯â€œåªè¯»â€å°±ç‚¹é€‰æˆâ€œå¯è¯»å†™â€ã€‚
** ä¿®æ”¹ profile
~sudo vim /etc/profile~ åœ¨æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š
#+begin_src bash
export PATH=/opt/local/bin:$PATH
export PATH=/opt/local/sbin:$PATH
#+end_src

ä¿®æ”¹å®Œæˆå¯å°† profile æ–‡ä»¶æ”¹å›â€œåªè¯»â€ã€‚

** ä¿®æ”¹ sources.conf
~sudo vim /opt/local/etc/macports/sources.conf~  æŠŠæœ€åä¸€è¡Œ ~rsync://~ å¼€å¤´çš„æ”¹æˆ
#+begin_src conf
# file:///Users/<usrname>/ports # è‡ªå·±æœ¬åœ°çš„ ports (å¯é€‰ï¼‰
rsync://pek.cn.rsync.macports.org/macports/release/tarballs/ports.tar [default]
#+end_src

å¦‚æœåŠ äº†æœ¬åœ°çš„ portsï¼Œå¹¶ä¸”portsä¹Ÿæ”¾åœ¨Githubï¼Œè¦ç¡®ä¿ç½‘ç»œèƒ½å¤Ÿè®¿é—® Githubï¼Œä¸ç„¶æ›´æ–° ports ä¼šå¤±è´¥ã€‚å¹¶å†ç°ä¸‹é¢çš„é”™è¯¯ï¼š
#+begin_src
Error: Couldn't sync the ports tree: Synchronization of 1 source failed
Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.
Error: /opt/local/bin/port: port selfupdate failed: Couldn't sync the ports tree: Synchronization of 1 source failed

#+end_src

** ä¿®æ”¹ macports.conf
~sudo vim /opt/local/etc/macports/macports.conf~ ä¿®æ”¹æ•´è¡Œ ~#rsync_server~ ä¸º
#+begin_src conf
rsync_server           pek.cn.rsync.macports.org
#+end_src

ä¿®æ”¹æ•´è¡Œ ~#rsync_server~ ä¸º
#+begin_src conf
rsync_dir           	macports/release/tarballs/base.tar
#+end_src

** Macports è¿è¡Œ
#+begin_src bash
sudo port -v sync	  # é‡æ–°åŠ è½½macportsæ–‡ä»¶ä¿¡æ¯
sudo port -v selfupdate	  # æ›´æ–°

sudo port sync	          # é‡æ–°åŠ è½½macportsæ–‡ä»¶ä¿¡æ¯
sudo port selfupdate	  # æ›´æ–°

port list                 # æŸ¥çœ‹Mac Portä¸­å½“å‰å¯ç”¨çš„è½¯ä»¶åŒ…åŠå…¶ç‰ˆæœ¬

port search name # æœç´¢ç´¢å¼•ä¸­çš„è½¯ä»¶

port info name # æŸ¥çœ‹åŒ…è¯¦ç»†ä¿¡æ¯

port deps name # æŸ¥çœ‹åŒ…è¯¦ç»†ä¿¡èµ–ä¿¡æ¯

port variants name # æŸ¥çœ‹å®‰è£…æ—¶å…è®¸å®¢æˆ·å®šåˆ¶çš„å‚æ•°

sudo port install name # å®‰è£…æ–°è½¯ä»¶

sudo port clean --all name # å®‰è£…å®Œæ¯•ä¹‹åï¼Œæ¸…é™¤å®‰è£…æ—¶äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶

sudo port uninstall name  # å¸è½½è½¯ä»¶

port outdated  # æŸ¥çœ‹æœ‰æ›´æ–°çš„è½¯ä»¶ä»¥åŠç‰ˆæœ¬

sudo port upgrade outdated  # å‡çº§å¯ä»¥æ›´æ–°çš„è½¯ä»¶

#+end_src
